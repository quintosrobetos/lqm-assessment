<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LQM Testing Panel</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #070F1E;
      color: #fff;
      padding: 40px;
      max-width: 600px;
      margin: 0 auto;
    }
    h1 {
      color: #00C8FF;
      margin-bottom: 30px;
    }
    .section {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }
    h2 {
      color: #00C8FF;
      font-size: 18px;
      margin: 0 0 16px 0;
    }
    button {
      background: linear-gradient(135deg, #0EA5E9, #00C8FF);
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      color: #070F1E;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,200,255,0.3);
    }
    button.danger {
      background: linear-gradient(135deg, #EF4444, #F87171);
    }
    .status {
      margin-top: 12px;
      padding: 12px;
      background: rgba(52,211,153,0.1);
      border: 1px solid rgba(52,211,153,0.3);
      border-radius: 8px;
      font-size: 13px;
      display: none;
    }
    .status.show {
      display: block;
    }
    code {
      background: rgba(0,0,0,0.3);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>‚ö° LQM Testing Panel</h1>
  
  <div class="section">
    <h2>Unlock Main Report (¬£9)</h2>
    <p style="font-size: 14px; color: rgba(255,255,255,0.6); margin-bottom: 16px;">
      Simulates completing payment for the main LQM report. Sets delivery reference and confirmation.
    </p>
    <button onclick="unlockReport()">‚úì Unlock Main Report</button>
    <div id="reportStatus" class="status"></div>
  </div>

  <div class="section">
    <h2>Unlock Add-Ons (¬£3 each)</h2>
    <p style="font-size: 14px; color: rgba(255,255,255,0.6); margin-bottom: 16px;">
      Simulates purchasing Neural Protocol and/or Quantum Living add-ons.
    </p>
    <button onclick="unlockNeural()">‚ö° Unlock Neural Protocol</button>
    <button onclick="unlockVital()">üå± Unlock Quantum Living</button>
    <button onclick="unlockBoth()">üîì Unlock Both Add-Ons</button>
    <div id="addonStatus" class="status"></div>
  </div>

  <div class="section">
    <h2>Reset Everything</h2>
    <p style="font-size: 14px; color: rgba(255,255,255,0.6); margin-bottom: 16px;">
      Clear all test data and start fresh. Use this to test the purchase flow again.
    </p>
    <button class="danger" onclick="resetAll()">‚Ü∫ Reset All Data</button>
    <div id="resetStatus" class="status"></div>
  </div>

  <div class="section">
    <h2>View Current Status</h2>
    <button onclick="showStatus()">üìä Check What's Unlocked</button>
    <div id="currentStatus" style="margin-top: 12px; font-size: 13px; color: rgba(255,255,255,0.7);"></div>
  </div>

  <div style="margin-top: 40px; text-align: center;">
    <a href="/" style="color: #00C8FF; text-decoration: none; font-size: 14px;">‚Üê Back to LQM App</a>
  </div>

  <script>
    function unlockReport() {
      const ref = "LQM-2026-TEST" + Math.random().toString(36).substring(2, 8).toUpperCase();
      const ts = new Date().toLocaleString("en-GB", {day:"2-digit", month:"short", year:"numeric", hour:"2-digit", minute:"2-digit"});
      
      localStorage.setItem("lqm_delivery", JSON.stringify({
        ref: ref,
        ts: ts,
        confirmed: true
      }));
      
      showMessage("reportStatus", `‚úì Main report unlocked!<br>Reference: <code>${ref}</code><br>Timestamp: ${ts}<br><br><strong>Now refresh the main app to see your report.</strong>`);
    }

    function unlockNeural() {
      const current = getUnlocks();
      current.neural = true;
      localStorage.setItem("lqm_unlocks", JSON.stringify(current));
      showMessage("addonStatus", "‚úì Neural Protocol unlocked!<br><strong>Refresh the app to see the ‚ö° Neural button in the header.</strong>");
    }

    function unlockVital() {
      const current = getUnlocks();
      current.vital = true;
      localStorage.setItem("lqm_unlocks", JSON.stringify(current));
      showMessage("addonStatus", "‚úì Quantum Living unlocked!<br><strong>Refresh the app to see the üå± Vital button in the header.</strong>");
    }

    function unlockBoth() {
      localStorage.setItem("lqm_unlocks", JSON.stringify({neural: true, vital: true}));
      showMessage("addonStatus", "‚úì Both add-ons unlocked!<br><strong>Refresh the app to see both header buttons.</strong>");
    }

    function resetAll() {
      localStorage.removeItem("lqm_delivery");
      localStorage.removeItem("lqm_unlocks");
      localStorage.removeItem("lqm_neural2");
      localStorage.removeItem("lqm_living");
      showMessage("resetStatus", "‚úì All data cleared!<br><strong>You can now test the full purchase flow from the beginning.</strong>");
    }

    function getUnlocks() {
      try {
        return JSON.parse(localStorage.getItem("lqm_unlocks") || "{}");
      } catch {
        return {};
      }
    }

    function showStatus() {
      const delivery = localStorage.getItem("lqm_delivery");
      const unlocks = getUnlocks();
      const neural = localStorage.getItem("lqm_neural2");
      const living = localStorage.getItem("lqm_living");

      let html = "<strong>Current Status:</strong><br><br>";
      
      html += "<strong>Main Report:</strong> " + (delivery ? "‚úì Unlocked" : "‚úó Locked") + "<br>";
      if (delivery) {
        const d = JSON.parse(delivery);
        html += `&nbsp;&nbsp;Ref: <code>${d.ref}</code><br>&nbsp;&nbsp;Time: ${d.ts}<br>`;
      }
      
      html += "<br><strong>Neural Protocol:</strong> " + (unlocks.neural ? "‚úì Unlocked" : "‚úó Locked") + "<br>";
      if (neural) {
        const n = JSON.parse(neural);
        html += `&nbsp;&nbsp;Total XP: ${n.totalXP || 0}<br>&nbsp;&nbsp;Streak: ${n.streak || 0} days<br>`;
      }
      
      html += "<br><strong>Quantum Living:</strong> " + (unlocks.vital ? "‚úì Unlocked" : "‚úó Locked") + "<br>";
      if (living) {
        const l = JSON.parse(living);
        html += `&nbsp;&nbsp;Streak: ${l.streak || 0} days<br>`;
      }

      document.getElementById("currentStatus").innerHTML = html;
    }

    function showMessage(id, msg) {
      const el = document.getElementById(id);
      el.innerHTML = msg;
      el.classList.add("show");
      setTimeout(() => {
        el.classList.remove("show");
      }, 8000);
    }
  </script>
</body>
</html>
